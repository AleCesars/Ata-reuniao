<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ata de Reunião Moderna</title>
    <!-- Inclui Tailwind CSS para estilização -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inclui a biblioteca html2pdf.js para exportar como PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* Um cinza muito claro, quase branco, para um look mais limpo */
            color: #334155; /* Cor de texto padrão mais suave */
        }
        .container {
            max-width: 1024px; /* Aumenta ligeiramente a largura máxima para mais espaço */
        }
        .card {
            background-color: #ffffff; /* Fundo branco puro para os cards */
            border-radius: 10px; /* Cantos arredondados ligeiramente mais suaves */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05); /* Sombra mais sutil e elegante */
            border: 1px solid #e2e8f0; /* Borda sutil para definir os cards */
        }
        .header-gradient {
            /* Cores da Companhia Athletica: Vermelho vibrante e um azul escuro/quase preto */
            background: linear-gradient(to right, #DC2626, #1A202C); /* Vermelho para azul escuro */
            border-radius: 10px 10px 0 0; /* Cantos arredondados apenas no topo */
        }
        .section-title {
            border-left: 4px solid #DC2626; /* Linha vermelha à esquerda do título da seção */
            padding-left: 1rem; /* Espaçamento ajustado */
            color: #1a202c; /* Cor de texto mais escura para títulos */
            font-weight: 600; /* Títulos um pouco mais pesados */
        }
        .task-item {
            border-bottom: 1px dashed #cbd5e0; /* Linha divisória tracejada mais discreta */
        }
        .task-item:last-child {
            border-bottom: none; /* Remove a linha da última tarefa */
        }
        .status-badge, .priority-badge {
            padding: 0.25rem 0.75rem; /* Ajuste de padding */
            border-radius: 9999px; /* Formato de pílula */
            font-size: 0.7rem; /* Fonte ligeiramente menor */
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.04em; /* Espaçamento entre letras sutil */
        }
        /* Cores dos status mais corporativas */
        .status-pendente {
            background-color: #fffbeb; /* Amarelo muito claro */
            color: #b45309; /* Laranja acastanhado */
            border: 1px solid #fcd34d;
        }
        .status-concluido {
            background-color: #ecfdf5; /* Verde muito claro */
            color: #047857; /* Verde floresta */
            border: 1px solid #34d399;
        }
        .status-em-progresso {
            background-color: #eff6ff; /* Azul muito claro */
            color: #2563eb; /* Azul médio */
            border: 1px solid #60a5fa;
        }
        /* Cores das prioridades mais corporativas */
        .priority-alta {
            background-color: #fef2f2; /* Vermelho muito claro */
            color: #dc2626; /* Vermelho mais suave */
            border: 1px solid #ef4444;
        }
        .priority-media {
            background-color: #fffbeb; /* Laranja muito claro */
            color: #d97706; /* Laranja acastanhado */
            border: 1px solid #fcd34d;
        }
        .priority-baixa {
            background-color: #f0f9ff; /* Azul muito claro */
            color: #3b82f6; /* Azul médio */
            border: 1px solid #93c5fd;
        }
        /* Estilos para o modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.5); /* Fundo mais escuro para o modal */
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: #ffffff;
            margin: auto;
            padding: 25px; /* Mais padding */
            border-radius: 10px;
            width: 90%;
            max-width: 650px; /* Ligeiramente maior */
            box-shadow: 0 8px 20px rgba(0,0,0,0.2); /* Sombra mais pronunciada */
            position: relative;
            text-align: left;
        }
        #modalBody {
            padding: 15px;
            background-color: #f9f9fb; /* Fundo ligeiramente diferente para a área de conteúdo do modal */
            border-radius: 6px;
            line-height: 1.7; /* Melhor espaçamento entre linhas */
            font-size: 0.95rem; /* Ajusta o tamanho da fonte */
            max-height: 450px; /* Altura máxima para conteúdo rolável */
            overflow-y: auto;
            color: #475569; /* Cor de texto legível */
        }
        .close-button {
            color: #64748b; /* Cor mais suave para o botão de fechar */
            float: right;
            font-size: 28px;
            font-weight: bold;
            transition: color 0.2s;
        }
        .close-button:hover,
        .close-button:focus {
            color: #1a202c;
            text-decoration: none;
            cursor: pointer;
        }
        /* Estilo para o spinner de carregamento */
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #DC2626; /* Cor do spinner alinhada com o tema corporativo */
            border-radius: 50%;
            width: 28px; /* Ligeiramente maior */
            height: 28px;
            animation: spin 1s linear infinite;
            display: none;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* Estilos para campos editáveis */
        [contenteditable="true"] {
            outline: none; /* Remove a borda tracejada padrão */
            border-bottom: 1px dashed #cbd5e0; /* Borda inferior sutil */
            padding: 2px 0px; /* Ajusta padding */
            min-width: 50px;
            transition: all 0.2s ease-in-out;
        }
        [contenteditable="true"]:focus {
            border-bottom: 1px solid #DC2626; /* Borda sólida mais forte ao focar */
            background-color: #fef2f2; /* Fundo vermelho muito claro ao focar */
        }
        /* Estilo para selects e inputs de data */
        select, input[type="date"], textarea {
            border: 1px solid #cbd5e0;
            border-radius: 6px;
            padding: 0.5rem 0.75rem;
            font-size: 0.9rem;
            color: #475569;
            transition: all 0.2s ease-in-out;
        }
        select:focus, input[type="date"]:focus, textarea:focus {
            border-color: #DC2626;
            box-shadow: 0 0 0 2px rgba(220, 38, 38, 0.2); /* Sombra com cor da marca */
            outline: none;
        }
        button {
            transition: all 0.2s ease-in-out;
        }

        /* Aumenta a fonte e deixa em negrito para as descrições das tarefas */
        .task-item .task-description {
            font-size: 1rem; /* Aumenta a fonte */
            font-weight: 500; /* Deixa um pouco mais negrito */
            color: #1a202c; /* Cor de texto mais escura para maior contraste */
        }

        /* Estilos para a logo */
        .header-logo {
            max-width: 100px; /* Tamanho máximo da logo */
            height: auto; /* Mantém a proporção */
            margin-right: 1rem; /* Espaçamento à direita do título */
            border-radius: 5px; /* Levemente arredondado */
        }

        /* Estilos específicos para impressão (PDF) */
        @media print {
            body {
                background-color: #ffffff !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                color: #212121;
                margin: 0; /* Remove margens do corpo para impressão */
                padding: 0; /* Remove padding do corpo para impressão */
            }
            .container {
                max-width: 100% !important;
                padding: 10mm 15mm !important; /* Adiciona padding para as margens da página no PDF */
                box-sizing: border-box; /* Inclui padding na largura total */
            }
            .card {
                box-shadow: none !important;
                border: none !important;
                border-radius: 0 !important;
                padding: 0 !important;
            }
            .header-gradient {
                background: #DC2626 !important; /* Cor sólida para impressão */
                box-shadow: none !important;
                border-radius: 0 !important;
                padding: 1rem 1.5rem !important;
                display: flex; /* Garante que logo e título fiquem lado a lado */
                align-items: center; /* Centraliza verticalmente */
                justify-content: flex-start; /* Alinha à esquerda */
            }
            .header-gradient h1 {
                font-size: 2.5rem !important; /* Larger title in print */
                line-height: 1.2; /* Ajusta line height para evitar quebras */
                word-wrap: break-word; /* Quebra palavras longas */
                white-space: normal; /* Permite quebra de linha normal */
            }
            .header-gradient p {
                font-size: 1.2rem !important; /* Larger subtitle in print */
                line-height: 1.2;
                word-wrap: break-word;
                white-space: normal;
            }
            .section-title {
                border-left: 4px solid #DC2626 !important;
                padding-left: 1rem !important;
                margin-bottom: 1rem !important;
                color: #1a202c !important;
                word-wrap: break-word;
                white-space: normal;
            }
            input[type="date"], select.status-select, select.priority-select {
                -webkit-appearance: none;
                -moz-appearance: none;
                appearance: none;
                border: none;
                padding: 0;
                background: none;
                color: inherit;
                font-size: inherit;
                line-height: inherit;
                width: auto;
                flex-grow: 0;
            }
            /* Ensure contenteditable elements look like plain text */
            [contenteditable="true"] {
                border-bottom: none !important;
                background-color: transparent !important;
                box-shadow: none !important;
                padding: 0 !important;
                word-wrap: break-word; /* Garante quebra de palavras */
                white-space: normal; /* Permite quebra de linha normal */
            }
            .remove-task-btn, .toggle-add-task-form-btn, .add-task-inline-form,
            #generateOverallSummaryBtn, #saveAsHtmlBtn, #saveAsPdfBtn, .modal,
            .filter-sort-controls, .add-task-inline-form + button { /* Added the + button for inline forms */
                display: none !important;
            }
            .task-group {
                margin-bottom: 1.5rem !important;
                padding-left: 0.5rem;
                /* Propriedades para controle de quebra de página */
                break-inside: avoid;
                page-break-inside: avoid;
            }
            .task-item {
                padding-left: 1rem !important;
                border-bottom: 1px dashed #cbd5e0 !important;
                padding-top: 0.5rem !important;
                padding-bottom: 0.5rem !important;
                /* Propriedades para controle de quebra de página */
                break-inside: avoid;
                page-break-inside: avoid;
            }
            .task-item:last-child {
                border-bottom: none !important;
            }
            ul.list-disc {
                padding-left: 1.5rem !important;
            }
            .status-badge, .priority-badge {
                background-color: transparent !important;
                color: #212121 !important;
                border: 1px solid #ccc !important;
                padding: 0.1rem 0.5rem !important;
                word-wrap: break-word;
                white-space: normal;
            }
            .status-pendente, .status-concluido, .status-em-progresso,
            .priority-alta, .priority-media, .priority-baixa {
                color: #212121 !important;
            }
            footer {
                margin-top: 2rem !important;
                color: #616161 !important;
                word-wrap: break-word;
                white-space: normal;
            }
            .header-logo {
                display: block !important;
                max-width: 80px !important; /* Ajusta o tamanho da logo para impressão */
                margin-right: 0.5rem !important;
            }
            /* Garante que as descrições das tarefas também quebrem corretamente */
            .task-item .task-description {
                word-wrap: break-word;
                white-space: normal;
            }
        }
    </style>
</head>
<body class="p-4 sm:p-8">
    <div class="container mx-auto">
        <!-- Cabeçalho da Ata -->
        <header class="header-gradient text-white p-6 rounded-t-xl shadow-lg mb-6 flex flex-col sm:flex-row justify-between items-center">
            <div class="mb-4 sm:mb-0 flex items-center">
                <!-- Logo da Companhia Athletica (Placeholder) -->
                <img src="CIA.png" alt="Logo Companhia Athletica" class="header-logo">
                <div>
                    <h1 class="text-3xl sm:text-4xl font-bold mb-2" contenteditable="true">Ata de Reunião</h1>
                    <p class="text-lg sm:text-xl font-light" contenteditable="true">25 de Junho de 2025</p>
                    <div class="text-sm mt-2 font-medium">
                        <span class="font-semibold">ID do Utilizador: </span><span id="userIdDisplay">Gerando ID...</span>
                    </div>
                </div>
            </div>
            <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4">
                <!-- Botão para Gerar Resumo Geral -->
                <button id="generateOverallSummaryBtn" class="bg-white text-blue-800 hover:bg-blue-100 font-bold py-2 px-4 rounded-full text-sm shadow-md transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300">Gerar Resumo Geral ✨</button>
                <!-- Botão para Salvar como HTML -->
                <button id="saveAsHtmlBtn" class="bg-white text-indigo-800 hover:bg-indigo-100 font-bold py-2 px-4 rounded-full text-sm shadow-md transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-indigo-300">Salvar como HTML 💾</button>
                <!-- Novo Botão para Salvar como PDF -->
                <button id="saveAsPdfBtn" class="bg-white text-red-700 hover:bg-red-100 font-bold py-2 px-4 rounded-full text-sm shadow-md transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300">Salvar como PDF 📄</button>
            </div>
        </header>

        <!-- Detalhes da Reunião -->
        <section class="card p-6 mb-6">
            <h2 class="text-2xl font-semibold mb-4 section-title">Detalhes da Reunião</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-gray-700">
                <div>
                    <p class="font-semibold text-gray-600">Data:</p>
                    <p contenteditable="true" id="meetingDate" class="text-gray-800">25 de Junho de 2025</p>
                </div>
                <div>
                    <p class="font-semibold text-gray-600">Próxima Reunião:</p>
                    <p contenteditable="true" id="nextMeetingDate" class="text-gray-800">30 de Julho de 2025 às 15:00</p>
                </div>
            </div>
        </section>

        <!-- Participantes -->
        <section class="card p-6 mb-6">
            <h2 class="text-2xl font-semibold mb-4 section-title">Participantes</h2>
            <ul class="list-disc list-inside text-gray-700 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2" id="participantsList">
                <li contenteditable="true" class="text-gray-800">Richard Bilton</li>
                <li contenteditable="true" class="text-gray-800">Joab Felipe</li>
                <li contenteditable="true" class="text-gray-800">Alexandre Cesar</li>
                <li contenteditable="true" class="text-gray-800">Vinicius Nascimento</li>
                <li contenteditable="true" class="text-gray-800">Lucas Ferreira</li>
                <li contenteditable="true" class="text-gray-800">Gabriela Maeda</li>
                <li contenteditable="true" class="text-gray-800">Bruno Freitas</li>
                <li contenteditable="true" class="text-gray-800">Carol Pedrosa</li>
                <li contenteditable="true" class="text-gray-800">Renato Scalercio</li>
                <li contenteditable="true" class="text-gray-800">Cleber Gio</li>
                <li contenteditable="true" class="text-gray-800">Ronaldo Sousa</li>
            </ul>
        </section>

        <!-- Tópicos e Ações -->
        <section class="card p-6 mb-6">
            <h2 class="text-2xl font-semibold mb-4 section-title">Tópicos e Ações</h2>

            <!-- Controles de Filtro e Ordenação -->
            <div class="filter-sort-controls flex flex-wrap gap-4 mb-6 p-4 bg-gray-50 rounded-lg shadow-inner border border-gray-200">
                <div class="flex-1 min-w-[150px]">
                    <label for="filterStatus" class="block text-sm font-medium text-gray-700 mb-1">Filtrar por Estado:</label>
                    <select id="filterStatus" class="block w-full pl-3 pr-10 py-2 text-base border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        <option value="all">Todos</option>
                        <option value="pendente">Pendente</option>
                        <option value="em-progresso">Em Progresso</option>
                        <option value="concluido">Concluído</option>
                    </select>
                </div>
                <div class="flex-1 min-w-[150px]">
                    <label for="sortOrder" class="block text-sm font-medium text-gray-700 mb-1">Ordenar por:</label>
                    <select id="sortOrder" class="block w-full pl-3 pr-10 py-2 text-base border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        <option value="default">Padrão</option>
                        <option value="deadline">Prazo</option>
                        <option value="status">Estado</option>
                        <option value="priority">Prioridade</option>
                        <option value="description">Descrição</option>
                    </select>
                </div>
            </div>

            <!-- Container para as tarefas existentes e novas -->
            <div id="tasksContainer">
                <!-- Bruna Almeida - CIPA / ASSÉDIO -->
                <div class="mb-6 task-group" data-responsible="Bruna Almeida - CIPA / ASSÉDIO">
                    <h3 class="text-xl font-bold mb-2 text-gray-800" contenteditable="true">1. Bruna Almeida - CIPA / ASSÉDIO</h3>
                    <div class="task-item py-3">
                        <p class="text-gray-700 task-description" contenteditable="true">Esclarecidas e reiteradas as regras para o canal de denúncias, em que a Bruna explicará a qualquer interessado como formalizar uma queixa/denúncia.</p>
                        <div class="flex items-center justify-between text-sm mt-2 flex-wrap gap-2">
                            <label class="text-gray-600">Prazo:</label>
                            <input type="date" value="2025-07-30" class="text-gray-700 border rounded px-2 py-1 text-sm flex-grow mr-2">
                            <label class="text-gray-600">Estado:</label>
                            <select class="status-select border rounded px-2 py-1 text-sm status-em-progresso">
                                <option value="em-progresso" selected>Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <label class="text-gray-600">Prioridade:</label>
                            <select class="priority-select border rounded px-2 py-1 text-sm priority-media">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <div class="flex space-x-2 mt-3">
                            <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300 remove-task-btn">Remover 🗑️</button>
                        </div>
                    </div>
                    <!-- Formulário para adicionar tarefa neste grupo -->
                    <div class="add-task-inline-form mt-4 p-4 border rounded-lg bg-gray-50 hidden">
                        <h4 class="font-semibold mb-2 text-gray-700">Adicionar Nova Tarefa:</h4>
                        <textarea class="shadow-sm border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mb-2 task-description-input-inline" rows="2" placeholder="Descrição da tarefa..."></textarea>
                        <div class="flex flex-wrap space-x-2 mb-2">
                            <input type="date" class="shadow-sm border rounded w-1/3 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-deadline-input-inline">
                            <select class="shadow-sm border rounded w-1/4 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-status-input-inline">
                                <option value="em-progresso">Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <select class="shadow-sm border rounded w-1/4 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-priority-input-inline">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 add-task-inline-btn">Adicionar</button>
                        <button class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-300 ml-2 cancel-add-task-inline-btn">Cancelar</button>
                    </div>
                    <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 toggle-add-task-form-btn mt-4">Adicionar Tarefa a este grupo +</button>
                </div>

                <!-- Lucas Ferreira - Manutenção Suprimentos e Serviços -->
                <div class="mb-6 task-group" data-responsible="Lucas Ferreira - Manutenção Suprimentos e Serviços">
                    <h3 class="text-xl font-bold mb-2 text-gray-800" contenteditable="true">2. Lucas Ferreira - Manutenção Suprimentos e Serviços</h3>
                    <div class="task-item py-3">
                        <p class="text-gray-700 task-description" contenteditable="true">Estudar a instalação do novo piso do cardio MOR/Persipisos - por R$ 60.000, 40% de entrada em 2x de 30/60. Elétrica com Matheus por R$ 7.000 reais. /// ARCHFLOOR recomendado pelo arquiteto - R$ 111K (Previsão Agosto).</p>
                        <div class="flex items-center justify-between text-sm mt-2 flex-wrap gap-2">
                            <label class="text-gray-600">Prazo:</label>
                            <input type="date" value="2025-08-25" class="text-gray-700 border rounded px-2 py-1 text-sm flex-grow mr-2">
                            <label class="text-gray-600">Estado:</label>
                            <select class="status-select border rounded px-2 py-1 text-sm status-em-progresso">
                                <option value="em-progresso" selected>Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <label class="text-gray-600">Prioridade:</label>
                            <select class="priority-select border rounded px-2 py-1 text-sm priority-alta">
                                <option value="alta" selected>Alta</option>
                                <option value="media">Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <div class="flex space-x-2 mt-3">
                            <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300 remove-task-btn">Remover 🗑️</button>
                        </div>
                    </div>
                    <div class="task-item py-3">
                        <p class="text-gray-700 task-description" contenteditable="true">Revestimento externo da escada em volta do elevador da CIA 111. Orçamento completo de R$ 13K.</p>
                        <div class="flex items-center justify-between text-sm mt-2 flex-wrap gap-2">
                            <label class="text-gray-600">Prazo:</label>
                            <input type="date" value="2025-07-30" class="text-gray-700 border rounded px-2 py-1 text-sm flex-grow mr-2">
                            <label class="text-gray-600">Estado:</label>
                            <select class="status-select border rounded px-2 py-1 text-sm status-em-progresso">
                                <option value="em-progresso" selected>Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <label class="text-gray-600">Prioridade:</label>
                            <select class="priority-select border rounded px-2 py-1 text-sm priority-media">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <div class="flex space-x-2 mt-3">
                            <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300 remove-task-btn">Remover 🗑️</button>
                        </div>
                    </div>
                    <div class="task-item py-3">
                        <p class="text-gray-700 task-description" contenteditable="true">Verificar orçamento para compra de plataforma elevatória (11 metros por R$ 46.900,00) e análise de um gerador usado/semi novo. /// Elevador da Cia111.</p>
                        <div class="flex items-center justify-between text-sm mt-2 flex-wrap gap-2">
                            <label class="text-gray-600">Prazo:</label>
                            <input type="date" value="2025-07-30" class="text-gray-700 border rounded px-2 py-1 text-sm flex-grow mr-2">
                            <label class="text-gray-600">Estado:</label>
                            <select class="status-select border rounded px-2 py-1 text-sm status-em-progresso">
                                <option value="em-progresso" selected>Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <label class="text-gray-600">Prioridade:</label>
                            <select class="priority-select border rounded px-2 py-1 text-sm priority-baixa">
                                <option value="alta">Alta</option>
                                <option value="media">Média</option>
                                <option value="baixa" selected>Baixa</option>
                            </select>
                        </div>
                        <div class="flex space-x-2 mt-3">
                            <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300 remove-task-btn">Remover 🗑️</button>
                        </div>
                    </div>
                    <div class="task-item py-3">
                        <p class="text-gray-700 task-description" contenteditable="true">Orçar a sala de prescrição da musculação. Carol cotará.</p>
                        <div class="flex items-center justify-between text-sm mt-2 flex-wrap gap-2">
                            <label class="text-gray-600">Prazo:</label>
                            <input type="date" value="2025-07-30" class="text-gray-700 border rounded px-2 py-1 text-sm flex-grow mr-2">
                            <label class="text-gray-600">Estado:</label>
                            <select class="status-select border rounded px-2 py-1 text-sm status-em-progresso">
                                <option value="em-progresso" selected>Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <label class="text-gray-600">Prioridade:</label>
                            <select class="priority-select border rounded px-2 py-1 text-sm priority-media">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <div class="flex space-x-2 mt-3">
                            <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300 remove-task-btn">Remover 🗑️</button>
                        </div>
                    </div>
                    <div class="task-item py-3">
                        <p class="text-gray-700 task-description" contenteditable="true">Verificar fechadura para porta da sala de lutas e sala Zen do Morumbi.</p>
                        <div class="flex items-center justify-between text-sm mt-2 flex-wrap gap-2">
                            <label class="text-gray-600">Prazo:</label>
                            <input type="date" value="2025-07-30" class="text-gray-700 border rounded px-2 py-1 text-sm flex-grow mr-2">
                            <label class="text-gray-600">Estado:</label>
                            <select class="status-select border rounded px-2 py-1 text-sm status-em-progresso">
                                <option value="em-progresso" selected>Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <label class="text-gray-600">Prioridade:</label>
                            <select class="priority-select border rounded px-2 py-1 text-sm priority-baixa">
                                <option value="alta">Alta</option>
                                <option value="media">Média</option>
                                <option value="baixa" selected>Baixa</option>
                            </select>
                        </div>
                        <div class="flex space-x-2 mt-3">
                            <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300 remove-task-btn">Remover 🗑️</button>
                        </div>
                    </div>
                    <div class="task-item py-3">
                        <p class="text-gray-700 task-description" contenteditable="true">Retirar duas caixas de som da sala 5 na Cia 111 e analisar a caixa de som do running class.</p>
                        <div class="flex items-center justify-between text-sm mt-2 flex-wrap gap-2">
                            <label class="text-gray-600">Prazo:</label>
                            <input type="date" value="2025-07-30" class="text-gray-700 border rounded px-2 py-1 text-sm flex-grow mr-2">
                            <label class="text-gray-600">Estado:</label>
                            <select class="status-select border rounded px-2 py-1 text-sm status-em-progresso">
                                <option value="em-progresso" selected>Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <label class="text-gray-600">Prioridade:</label>
                            <select class="priority-select border rounded px-2 py-1 text-sm priority-baixa">
                                <option value="alta">Alta</option>
                                <option value="media">Média</option>
                                <option value="baixa" selected>Baixa</option>
                            </select>
                        </div>
                        <div class="flex space-x-2 mt-3">
                            <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300 remove-task-btn">Remover 🗑️</button>
                        </div>
                    </div>
                    <div class="task-item py-3">
                        <p class="text-gray-700 task-description" contenteditable="true">Finalizar trabalho de envelopamento.</p>
                        <div class="flex items-center justify-between text-sm mt-2 flex-wrap gap-2">
                            <label class="text-gray-600">Prazo:</label>
                            <input type="date" value="2025-07-30" class="text-gray-700 border rounded px-2 py-1 text-sm flex-grow mr-2">
                            <label class="text-gray-600">Estado:</label>
                            <select class="status-select border rounded px-2 py-1 text-sm status-em-progresso">
                                <option value="em-progresso" selected>Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <label class="text-gray-600">Prioridade:</label>
                            <select class="priority-select border rounded px-2 py-1 text-sm priority-media">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <div class="flex space-x-2 mt-3">
                            <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300 remove-task-btn">Remover 🗑️</button>
                        </div>
                    </div>
                    <!-- Formulário para adicionar tarefa neste grupo -->
                    <div class="add-task-inline-form mt-4 p-4 border rounded-lg bg-gray-50 hidden">
                        <h4 class="font-semibold mb-2 text-gray-700">Adicionar Nova Tarefa:</h4>
                        <textarea class="shadow-sm border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mb-2 task-description-input-inline" rows="2" placeholder="Descrição da tarefa..."></textarea>
                        <div class="flex flex-wrap space-x-2 mb-2">
                            <input type="date" class="shadow-sm border rounded w-1/3 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-deadline-input-inline">
                            <select class="shadow-sm border rounded w-1/4 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-status-input-inline">
                                <option value="em-progresso">Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <select class="shadow-sm border rounded w-1/4 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-priority-input-inline">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 add-task-inline-btn">Adicionar</button>
                        <button class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-300 ml-2 cancel-add-task-inline-btn">Cancelar</button>
                    </div>
                    <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 toggle-add-task-form-btn mt-4">Adicionar Tarefa a este grupo +</button>
                </div>

                <!-- Renato - Musculação Morumbi -->
                <div class="mb-6 task-group" data-responsible="Renato - Musculação Morumbi">
                    <h3 class="text-xl font-bold mb-2 text-gray-800" contenteditable="true">6. Renato - Musculação Morumbi</h3>
                    <div class="task-item py-3">
                        <p class="text-gray-700 task-description" contenteditable="true">Colocar botão de ajuda nos equipamentos da musculação - MOR (AX SYSTEMS) Orçamento R$ 6.900,00 (6 relógios x 1150).</p>
                        <div class="flex items-center justify-between text-sm mt-2 flex-wrap gap-2">
                            <label class="text-gray-600">Prazo:</label>
                            <input type="date" value="2025-07-30" class="text-gray-700 border rounded px-2 py-1 text-sm flex-grow mr-2">
                            <label class="text-gray-600">Estado:</label>
                            <select class="status-select border rounded px-2 py-1 text-sm status-em-progresso">
                                <option value="em-progresso" selected>Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <label class="text-gray-600">Prioridade:</label>
                            <select class="priority-select border rounded px-2 py-1 text-sm priority-alta">
                                <option value="alta" selected>Alta</option>
                                <option value="media">Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <div class="flex space-x-2 mt-3">
                            <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300 remove-task-btn">Remover 🗑️</button>
                        </div>
                    </div>
                    <div class="task-item py-3">
                        <p class="text-gray-700 task-description" contenteditable="true">Trocar as 8 bikes da musculação. Valor: 18K sem tela touch.</p>
                        <div class="flex items-center justify-between text-sm mt-2 flex-wrap gap-2">
                            <label class="text-gray-600">Prazo:</label>
                            <input type="date" value="2025-07-30" class="text-gray-700 border rounded px-2 py-1 text-sm flex-grow mr-2">
                            <label class="text-gray-600">Estado:</label>
                            <select class="status-select border rounded px-2 py-1 text-sm status-em-progresso">
                                <option value="em-progresso" selected>Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <label class="text-gray-600">Prioridade:</label>
                            <select class="priority-select border rounded px-2 py-1 text-sm priority-media">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <div class="flex space-x-2 mt-3">
                            <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300 remove-task-btn">Remover 🗑️</button>
                        </div>
                    </div>
                    <!-- Formulário para adicionar tarefa neste grupo -->
                    <div class="add-task-inline-form mt-4 p-4 border rounded-lg bg-gray-50 hidden">
                        <h4 class="font-semibold mb-2 text-gray-700">Adicionar Nova Tarefa:</h4>
                        <textarea class="shadow-sm border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mb-2 task-description-input-inline" rows="2" placeholder="Descrição da tarefa..."></textarea>
                        <div class="flex flex-wrap space-x-2 mb-2">
                            <input type="date" class="shadow-sm border rounded w-1/3 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-deadline-input-inline">
                            <select class="shadow-sm border rounded w-1/4 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-status-input-inline">
                                <option value="em-progresso">Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <select class="shadow-sm border rounded w-1/4 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-priority-input-inline">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 add-task-inline-btn">Adicionar</button>
                        <button class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-300 ml-2 cancel-add-task-inline-btn">Cancelar</button>
                    </div>
                    <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 toggle-add-task-form-btn mt-4">Adicionar Tarefa a este grupo +</button>
                </div>

                <!-- Alexandre - TI Cia 111 -->
                <div class="mb-6 task-group" data-responsible="Alexandre - TI Cia 111">
                    <h3 class="text-xl font-bold mb-2 text-gray-800" contenteditable="true">7. Alexandre - TI Cia 111</h3>
                    <div class="task-item py-3">
                        <p class="text-gray-700 task-description" contenteditable="true">Atualização do videowall e redes sociais da Cia111 e colocar mais volume de conteúdo.</p>
                        <div class="flex items-center justify-between text-sm mt-2 flex-wrap gap-2">
                            <label class="text-gray-600">Prazo:</label>
                            <input type="date" value="2025-07-30" class="text-gray-700 border rounded px-2 py-1 text-sm flex-grow mr-2">
                            <label class="text-gray-600">Estado:</label>
                            <select class="status-select border rounded px-2 py-1 text-sm status-em-progresso">
                                <option value="em-progresso" selected>Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <label class="text-gray-600">Prioridade:</label>
                            <select class="priority-select border rounded px-2 py-1 text-sm priority-media">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <div class="flex space-x-2 mt-3">
                            <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300 remove-task-btn">Remover 🗑️</button>
                        </div>
                    </div>
                    <!-- Formulário para adicionar tarefa neste grupo -->
                    <div class="add-task-inline-form mt-4 p-4 border rounded-lg bg-gray-50 hidden">
                        <h4 class="font-semibold mb-2 text-gray-700">Adicionar Nova Tarefa:</h4>
                        <textarea class="shadow-sm border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mb-2 task-description-input-inline" rows="2" placeholder="Descrição da tarefa..."></textarea>
                        <div class="flex flex-wrap space-x-2 mb-2">
                            <input type="date" class="shadow-sm border rounded w-1/3 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-deadline-input-inline">
                            <select class="shadow-sm border rounded w-1/4 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-status-input-inline">
                                <option value="em-progresso">Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <select class="shadow-sm border rounded w-1/4 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-priority-input-inline">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 add-task-inline-btn">Adicionar</button>
                        <button class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-300 ml-2 cancel-add-task-inline-btn">Cancelar</button>
                    </div>
                    <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 toggle-add-task-form-btn mt-4">Adicionar Tarefa a este grupo +</button>
                </div>

                <!-- Cleber - Marketing -->
                <div class="mb-6 task-group" data-responsible="Cleber - Marketing">
                    <h3 class="text-xl font-bold mb-2 text-gray-800" contenteditable="true">8. Cleber - Marketing</h3>
                    <div class="task-item py-3">
                        <p class="text-gray-700 task-description" contenteditable="true">Atualização do videowall e redes sociais da Cia111 e colocar mais volume de conteúdo.</p>
                        <div class="flex items-center justify-between text-sm mt-2 flex-wrap gap-2">
                            <label class="text-gray-600">Prazo:</label>
                            <input type="date" value="2025-07-30" class="text-gray-700 border rounded px-2 py-1 text-sm flex-grow mr-2">
                            <label class="text-gray-600">Estado:</label>
                            <select class="status-select border rounded px-2 py-1 text-sm status-em-progresso">
                                <option value="em-progresso" selected>Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <label class="text-gray-600">Prioridade:</label>
                            <select class="priority-select border rounded px-2 py-1 text-sm priority-media">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <div class="flex space-x-2 mt-3">
                            <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300 remove-task-btn">Remover 🗑️</button>
                        </div>
                    </div>
                    <div class="task-item py-3">
                        <p class="text-gray-700 task-description" contenteditable="true">Fazer conteúdo de Step e Axis para adicionar no video wall. Gravar aulão de Axis em Julho. Material dos botões de ajuda no video wall.</p>
                        <div class="flex items-center justify-between text-sm mt-2 flex-wrap gap-2">
                            <label class="text-gray-600">Prazo:</label>
                            <input type="date" value="2025-07-30" class="text-gray-700 border rounded px-2 py-1 text-sm flex-grow mr-2">
                            <label class="text-gray-600">Estado:</label>
                            <select class="status-select border rounded px-2 py-1 text-sm status-em-progresso">
                                <option value="em-progresso" selected>Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <label class="text-gray-600">Prioridade:</label>
                            <select class="priority-select border rounded px-2 py-1 text-sm priority-media">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <div class="flex space-x-2 mt-3">
                            <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300 remove-task-btn">Remover 🗑️</button>
                        </div>
                    </div>
                    <!-- Formulário para adicionar tarefa neste grupo -->
                    <div class="add-task-inline-form mt-4 p-4 border rounded-lg bg-gray-50 hidden">
                        <h4 class="font-semibold mb-2 text-gray-700">Adicionar Nova Tarefa:</h4>
                        <textarea class="shadow-sm border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mb-2 task-description-input-inline" rows="2" placeholder="Descrição da tarefa..."></textarea>
                        <div class="flex flex-wrap space-x-2 mb-2">
                            <input type="date" class="shadow-sm border rounded w-1/3 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-deadline-input-inline">
                            <select class="shadow-sm border rounded w-1/4 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-status-input-inline">
                                <option value="em-progresso">Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <select class="shadow-sm border rounded w-1/4 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-priority-input-inline">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 add-task-inline-btn">Adicionar</button>
                        <button class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-300 ml-2 cancel-add-task-inline-btn">Cancelar</button>
                    </div>
                    <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 toggle-add-task-form-btn mt-4">Adicionar Tarefa a este grupo +</button>
                </div>

                <!-- Gabriela - Vendas -->
                <div class="mb-6 task-group" data-responsible="Gabriela - Vendas">
                    <h3 class="text-xl font-bold mb-2 text-gray-800" contenteditable="true">9. Gabriela - Vendas</h3>
                    <div class="task-item py-3">
                        <p class="text-gray-700 task-description" contenteditable="true">Total: 3076 em 31/05 - Preço médio: 469,89. Meta: 4000 sendo 2300 MOR e 1700 Cia111.</p>
                        <div class="flex items-center justify-between text-sm mt-2 flex-wrap gap-2">
                            <label class="text-gray-600">Prazo:</label>
                            <input type="date" value="2025-07-30" class="text-gray-700 border rounded px-2 py-1 text-sm flex-grow mr-2">
                            <label class="text-gray-600">Estado:</label>
                            <select class="status-select border rounded px-2 py-1 text-sm status-em-progresso">
                                <option value="em-progresso" selected>Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <label class="text-gray-600">Prioridade:</label>
                            <select class="priority-select border rounded px-2 py-1 text-sm priority-alta">
                                <option value="alta" selected>Alta</option>
                                <option value="media">Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <div class="flex space-x-2 mt-3">
                            <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300 remove-task-btn">Remover 🗑️</button>
                        </div>
                    </div>
                    <!-- Formulário para adicionar tarefa neste grupo -->
                    <div class="add-task-inline-form mt-4 p-4 border rounded-lg bg-gray-50 hidden">
                        <h4 class="font-semibold mb-2 text-gray-700">Adicionar Nova Tarefa:</h4>
                        <textarea class="shadow-sm border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mb-2 task-description-input-inline" rows="2" placeholder="Descrição da tarefa..."></textarea>
                        <div class="flex flex-wrap space-x-2 mb-2">
                            <input type="date" class="shadow-sm border rounded w-1/3 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-deadline-input-inline">
                            <select class="shadow-sm border rounded w-1/4 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-status-input-inline">
                                <option value="em-progresso">Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <select class="shadow-sm border rounded w-1/4 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-priority-input-inline">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 add-task-inline-btn">Adicionar</button>
                        <button class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-300 ml-2 cancel-add-task-inline-btn">Cancelar</button>
                    </div>
                    <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 toggle-add-task-form-btn mt-4">Adicionar Tarefa a este grupo +</button>
                </div>

                <!-- Carol Pedrosa - Ginástica -->
                <div class="mb-6 task-group" data-responsible="Carol Pedrosa - Ginástica">
                    <h3 class="text-xl font-bold mb-2 text-gray-800" contenteditable="true">10. Carol Pedrosa - Ginástica</h3>
                    <div class="task-item py-3">
                        <p class="text-gray-700 task-description" contenteditable="true">Testar fita de monitoramento de braço para testar no OZ.</p>
                        <div class="flex items-center justify-between text-sm mt-2 flex-wrap gap-2">
                            <label class="text-gray-600">Prazo:</label>
                            <input type="date" value="2025-07-30" class="text-gray-700 border rounded px-2 py-1 text-sm flex-grow mr-2">
                            <label class="text-gray-600">Estado:</label>
                            <select class="status-select border rounded px-2 py-1 text-sm status-em-progresso">
                                <option value="em-progresso" selected>Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <label class="text-gray-600">Prioridade:</label>
                            <select class="priority-select border rounded px-2 py-1 text-sm priority-media">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <div class="flex space-x-2 mt-3">
                            <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300 remove-task-btn">Remover 🗑️</button>
                        </div>
                    </div>
                    <div class="task-item py-3">
                        <p class="text-gray-700 task-description" contenteditable="true">Verificar fechadura para sala de lutas e sala Zen do Morumbi.</p>
                        <div class="flex items-center justify-between text-sm mt-2 flex-wrap gap-2">
                            <label class="text-gray-600">Prazo:</label>
                            <input type="date" value="2025-07-30" class="text-gray-700 border rounded px-2 py-1 text-sm flex-grow mr-2">
                            <label class="text-gray-600">Estado:</label>
                            <select class="status-select border rounded px-2 py-1 text-sm status-em-progresso">
                                <option value="em-progresso" selected>Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <label class="text-gray-600">Prioridade:</label>
                            <select class="priority-select border rounded px-2 py-1 text-sm priority-baixa">
                                <option value="alta">Alta</option>
                                <option value="media">Média</option>
                                <option value="baixa" selected>Baixa</option>
                            </select>
                        </div>
                        <div class="flex space-x-2 mt-3">
                            <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300 remove-task-btn">Remover 🗑️</button>
                        </div>
                    </div>
                    <!-- Formulário para adicionar tarefa neste grupo -->
                    <div class="add-task-inline-form mt-4 p-4 border rounded-lg bg-gray-50 hidden">
                        <h4 class="font-semibold mb-2 text-gray-700">Adicionar Nova Tarefa:</h4>
                        <textarea class="shadow-sm border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mb-2 task-description-input-inline" rows="2" placeholder="Descrição da tarefa..."></textarea>
                        <div class="flex flex-wrap space-x-2 mb-2">
                            <input type="date" class="shadow-sm border rounded w-1/3 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-deadline-input-inline">
                            <select class="shadow-sm border rounded w-1/4 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-status-input-inline">
                                <option value="em-progresso">Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <select class="shadow-sm border rounded w-1/4 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-priority-input-inline">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 add-task-inline-btn">Adicionar</button>
                        <button class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-300 ml-2 cancel-add-task-inline-btn">Cancelar</button>
                    </div>
                    <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 toggle-add-task-form-btn mt-4">Adicionar Tarefa a este grupo +</button>
                </div>

                <!-- Gerentes -->
                <div class="mb-6 task-group" data-responsible="Gerentes">
                    <h3 class="text-xl font-bold mb-2 text-gray-800" contenteditable="true">11. Gerentes</h3>
                    <div class="task-item py-3">
                        <p class="text-gray-700 task-description" contenteditable="true">Entregar férias para Setembro de 2025 até o fechamento do ponto de Julho. Tentar programar como CWB.</p>
                        <div class="flex items-center justify-between text-sm mt-2 flex-wrap gap-2">
                            <label class="text-gray-600">Prazo:</label>
                            <input type="date" value="" class="text-gray-700 border rounded px-2 py-1 text-sm flex-grow mr-2">
                            <label class="text-gray-600">Estado:</label>
                            <select class="status-select border rounded px-2 py-1 text-sm status-em-progresso">
                                <option value="em-progresso" selected>Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <label class="text-gray-600">Prioridade:</label>
                            <select class="priority-select border rounded px-2 py-1 text-sm priority-media">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <div class="flex space-x-2 mt-3">
                            <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300 remove-task-btn">Remover 🗑️</button>
                        </div>
                    </div>
                    <!-- Formulário para adicionar tarefa neste grupo -->
                    <div class="add-task-inline-form mt-4 p-4 border rounded-lg bg-gray-50 hidden">
                        <h4 class="font-semibold mb-2 text-gray-700">Adicionar Nova Tarefa:</h4>
                        <textarea class="shadow-sm border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mb-2 task-description-input-inline" rows="2" placeholder="Descrição da tarefa..."></textarea>
                        <div class="flex flex-wrap space-x-2 mb-2">
                            <input type="date" class="shadow-sm border rounded w-1/3 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-deadline-input-inline">
                            <select class="shadow-sm border rounded w-1/4 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-status-input-inline">
                                <option value="em-progresso">Em Progresso</option>
                                <option value="pendente">Pendente</option>
                                <option value="concluido">Concluído</option>
                            </select>
                            <select class="shadow-sm border rounded w-1/4 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-priority-input-inline">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Média</option>
                                <option value="baixa">Baixa</option>
                            </select>
                        </div>
                        <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 add-task-inline-btn">Adicionar</button>
                        <button class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-300 ml-2 cancel-add-task-inline-btn">Cancelar</button>
                    </div>
                    <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 toggle-add-task-form-btn mt-4">Adicionar Tarefa a este grupo +</button>
                </div>

                <!-- Apresentações -->
                <div class="mb-6 task-group" data-responsible="Apresentações">
                    <h3 class="text-xl font-bold mb-2 text-gray-800" contenteditable="true">12. Apresentações</h3>
                    <ul class="list-disc list-inside text-gray-700" id="presentationsList">
                        <li contenteditable="true" class="text-gray-800">Junho - Área técnica (musculação)</li>
                        <li contenteditable="true" class="text-gray-800">Julho - Ginástica e lutas</li>
                        <li contenteditable="true" class="text-gray-800">Agosto - Marketing e Platinum</li>
                        <li contenteditable="true" class="text-gray-800">Setembro - Recepção e Vendas</li>
                        <li contenteditable="true" class="text-gray-800">Outubro - Área técnica (musculação)</li>
                    </ul>
                    <!-- Formulário para adicionar item de apresentação neste grupo -->
                    <div class="add-task-inline-form mt-4 p-4 border rounded-lg bg-gray-50 hidden">
                        <h4 class="font-semibold mb-2 text-gray-700">Adicionar Nova Apresentação:</h4>
                        <textarea class="shadow-sm border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mb-2 task-description-input-inline" rows="2" placeholder="Descrição da apresentação..."></textarea>
                        <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 add-presentation-inline-btn">Adicionar</button>
                        <button class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-300 ml-2 cancel-add-task-inline-btn">Cancelar</button>
                    </div>
                    <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 toggle-add-task-form-btn mt-4">Adicionar Apresentação +</button>
                </div>
            </div>
        </section>

        <!-- Rodapé -->
        <footer class="text-center text-gray-600 text-sm mt-8">
            <p>&copy; 2025 Companhia Athletica. Todos os direitos reservados.</p>
            <p contenteditable="true" class="text-gray-700">Gerado em 25 de Junho de 2025</p>
        </footer>
    </div>

    <!-- Modal para exibir o resumo/sugestões -->
    <div id="responseModal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h3 id="modalTitle" class="text-xl font-bold mb-4 text-gray-800"></h3>
            <div id="modalBody" class="text-gray-700"></div>
            <div id="loadingSpinner" class="spinner mx-auto mt-4"></div>
        </div>
    </div>

    <!-- Modal para Configuração Gemini API -->
    <div id="configModal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="closeConfigModal">&times;</span>
            <h3 id="configModalTitle" class="text-xl font-bold mb-4 text-gray-800">Configuração Necessária</h3>
            <div id="configModalBody" class="text-gray-700 mb-4">
                <p class="mb-4">Para que a funcionalidade de gerar resumos funcione, por favor, insira a sua chave da API Gemini.</p>
                <p class="mb-2 font-semibold">Chave da API Gemini:</p>
                <p class="text-sm text-gray-600 mb-2">Obtenha a sua chave no <a href="https://aistudio.google.com/app/apikey" target="_blank" class="text-blue-600 hover:underline">Google AI Studio</a>.</p>
                <input type="text" id="geminiApiKey" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 mb-4">
            </div>
            <div class="flex justify-end space-x-3">
                <button id="saveConfigBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-sm shadow-md transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300">Guardar Configuração</button>
                <button id="resetConfigBtn" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-full text-sm shadow-md transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-300">Redefinir</button>
            </div>
        </div>
    </div>

    <script type="module">
        // Não há imports do Firebase SDK, pois o Firebase foi removido.

        // Variáveis globais do ambiente Canvas (não usadas, mas mantidas como null para compatibilidade)
        const canvasAppId = null;
        const canvasFirebaseConfig = null;
        const canvasInitialAuthToken = null;

        let currentUserId = null; // ID do utilizador gerado localmente, sem persistência

        const LOCAL_STORAGE_CONFIG_KEY = 'ataMeetingAppConfig'; // Usado para guardar a chave Gemini
        const LOCAL_STORAGE_DATA_KEY = 'ataMeetingData'; // Nova chave para os dados da ata

        // Elements for config modal
        const configModal = document.getElementById('configModal');
        const closeConfigModalBtn = document.getElementById('closeConfigModal');
        const saveConfigBtn = document.getElementById('saveConfigBtn');
        const resetConfigBtn = document.getElementById('resetConfigBtn');

        // Apenas input para a chave Gemini, inputs Firebase removidos
        const geminiApiKeyInput = document.getElementById('geminiApiKey');


        document.addEventListener('DOMContentLoaded', () => {
            const generateOverallSummaryBtn = document.getElementById('generateOverallSummaryBtn');
            const saveAsHtmlBtn = document.getElementById('saveAsHtmlBtn');
            const saveAsPdfBtn = document.getElementById('saveAsPdfBtn');
            const responseModal = document.getElementById('responseModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');
            const closeButton = document.querySelector('.close-button');
            const loadingSpinner = document.getElementById('loadingSpinner');
            const tasksContainer = document.getElementById('tasksContainer');
            const userIdDisplay = document.getElementById('userIdDisplay');

            const meetingTitle = document.querySelector('h1[contenteditable="true"]');
            const meetingDate = document.getElementById('meetingDate');
            const nextMeetingDate = document.getElementById('nextMeetingDate');
            const participantsList = document.getElementById('participantsList');
            const footerDate = document.querySelector('footer p[contenteditable="true"]');

            // Declarations for currentFilter and currentSort
            let currentFilter = 'all'; // 'all', 'pendente', 'em-progresso', 'concluido'
            let currentSort = 'default'; // 'default', 'deadline', 'status', 'priority', 'description'

            const filterStatusSelect = document.getElementById('filterStatus');
            const sortOrderSelect = document.getElementById('sortOrder');

            let saveTimeout; // Variável para o debounce

            // Initial call to set up app logic (no Firebase init)
            initAppLogic();

            // --- Config Modal Functions ---
            function showConfigModal(title, message) {
                document.getElementById('configModalTitle').textContent = title;
                document.getElementById('configModalBody').querySelector('p').textContent = message; // Update message
                const config = loadConfig();
                geminiApiKeyInput.value = config.geminiApiKey || '';
                configModal.style.display = 'flex';
            }

            function hideConfigModal() {
                configModal.style.display = 'none';
            }

            function loadConfig() {
                try {
                    const storedConfig = localStorage.getItem(LOCAL_STORAGE_CONFIG_KEY);
                    return storedConfig ? JSON.parse(storedConfig) : {};
                } catch (e) {
                    console.error('Erro ao carregar configuração do localStorage:', e);
                    return {};
                }
            }

            function saveConfigToLocalStorage() {
                const config = {
                    geminiApiKey: geminiApiKeyInput.value.trim()
                };
                localStorage.setItem(LOCAL_STORAGE_CONFIG_KEY, JSON.stringify(config));
                console.log('Configuração salva no localStorage.');
                return config;
            }

            function resetConfig() {
                localStorage.removeItem(LOCAL_STORAGE_CONFIG_KEY);
                localStorage.removeItem(LOCAL_STORAGE_DATA_KEY); // Limpa também os dados da ata
                geminiApiKeyInput.value = '';
                console.log('Configuração e dados redefinidos.');
                // Recarrega a página para aplicar o reset completo
                window.location.reload();
            }

            saveConfigBtn.addEventListener('click', () => {
                const newConfig = saveConfigToLocalStorage();
                if (!newConfig.geminiApiKey) {
                    showModal('Atenção', 'Por favor, preencha a Chave da API Gemini.');
                    return;
                }
                hideConfigModal();
                initAppLogic(); // Re-initialize app logic with new config
            });

            closeConfigModalBtn.addEventListener('click', hideConfigModal);
            resetConfigBtn.addEventListener('click', resetConfig);

            // --- App Logic (without Firebase) ---
            async function initAppLogic() {
                const config = loadConfig();
                const geminiKey = config.geminiApiKey;

                if (!geminiKey) {
                    showConfigModal('Configuração Necessária', 'Por favor, insira a sua chave da API Gemini para usar a funcionalidade de resumo.');
                }

                // Generate a random user ID for this session (no persistence)
                if (!currentUserId) {
                    currentUserId = crypto.randomUUID(); // Generates a unique ID
                    userIdDisplay.textContent = currentUserId;
                    console.log('ID do Utilizador gerado para a sessão:', currentUserId);
                }

                // Load saved data when the app initializes
                loadMeetingData();

                // We just need to ensure listeners are attached and filters applied.
                attachListeners();
                addInputListeners();
                applyFiltersAndSort();
            }

            // Função para salvar os dados da reunião no localStorage
            function saveMeetingData() {
                clearTimeout(saveTimeout); // Limpa qualquer timeout anterior
                saveTimeout = setTimeout(() => {
                    try {
                        const meetingData = {
                            meetingTitle: meetingTitle.textContent.trim(),
                            meetingDate: meetingDate.textContent.trim(),
                            nextMeetingDate: nextMeetingDate.textContent.trim(),
                            participants: Array.from(participantsList.children).map(li => li.textContent.trim()),
                            taskGroups: [],
                            presentations: []
                        };

                        // Coleta os grupos de tarefas
                        document.querySelectorAll('.task-group').forEach(groupDiv => {
                            const responsibleElement = groupDiv.querySelector('h3');
                            const responsible = responsibleElement ? responsibleElement.textContent.trim().replace(/^\d+\.\s*/, '') : '';

                            // Verifica se é um grupo de apresentações
                            if (groupDiv.querySelector('#presentationsList')) {
                                meetingData.presentations = Array.from(groupDiv.querySelectorAll('#presentationsList li')).map(li => li.textContent.trim());
                            } else {
                                const tasks = [];
                                groupDiv.querySelectorAll('.task-item').forEach(taskItem => {
                                    const description = taskItem.querySelector('.task-description').textContent.trim();
                                    const deadline = taskItem.querySelector('input[type="date"]').value;
                                    const status = taskItem.querySelector('.status-select').value;
                                    const priority = taskItem.querySelector('.priority-select').value;
                                    tasks.push({ description, deadline, status, priority });
                                });
                                if (responsible && tasks.length > 0) { // Só adiciona se tiver responsável e tarefas
                                    meetingData.taskGroups.push({ responsible, tasks });
                                }
                            }
                        });

                        localStorage.setItem(LOCAL_STORAGE_DATA_KEY, JSON.stringify(meetingData));
                        console.log('Dados da reunião salvos automaticamente no localStorage.');
                    } catch (e) {
                        console.error('Erro ao salvar dados no localStorage:', e);
                    }
                }, 1000); // Salva após 1 segundo de inatividade
            }

            // Função para carregar os dados da reunião do localStorage
            function loadMeetingData() {
                try {
                    const savedData = localStorage.getItem(LOCAL_STORAGE_DATA_KEY);
                    if (savedData) {
                        const meetingData = JSON.parse(savedData);

                        // Popula os detalhes da reunião
                        meetingTitle.textContent = meetingData.meetingTitle || 'Ata de Reunião';
                        meetingDate.textContent = meetingData.meetingDate || '25 de Junho de 2025';
                        nextMeetingDate.textContent = meetingData.nextMeetingDate || '30 de Julho de 2025 às 15:00';

                        // Popula os participantes
                        participantsList.innerHTML = '';
                        if (meetingData.participants && meetingData.participants.length > 0) {
                            meetingData.participants.forEach(participant => {
                                const li = document.createElement('li');
                                li.contentEditable = true;
                                li.textContent = participant;
                                participantsList.appendChild(li);
                            });
                        } else {
                            // Se não houver participantes salvos, restaura os padrões ou deixa vazio
                            ['Richard Bilton', 'Joab Felipe', 'Alexandre Cesar', 'Vinicius Nascimento', 'Lucas Ferreira', 'Gabriela Maeda', 'Bruno Freitas', 'Carol Pedrosa', 'Renato Scalercio', 'Cleber Gio', 'Ronaldo Sousa'].forEach(p => {
                                const li = document.createElement('li');
                                li.contentEditable = true;
                                li.textContent = p;
                                participantsList.appendChild(li);
                            });
                        }


                        // Limpa o container de tarefas antes de recarregar
                        tasksContainer.innerHTML = '';

                        // Popula os grupos de tarefas
                        if (meetingData.taskGroups && meetingData.taskGroups.length > 0) {
                            meetingData.taskGroups.forEach(group => {
                                const groupDiv = document.createElement('div');
                                groupDiv.classList.add('mb-6', 'task-group');
                                groupDiv.setAttribute('data-responsible', group.responsible);

                                const h3 = document.createElement('h3');
                                h3.classList.add('text-xl', 'font-bold', 'mb-2', 'text-gray-800');
                                h3.contentEditable = true;
                                h3.textContent = `${group.responsible}`; // O número será adicionado por renumberTaskGroups
                                groupDiv.appendChild(h3);

                                group.tasks.forEach(task => {
                                    const taskItem = document.createElement('div');
                                    taskItem.classList.add('task-item', 'py-3');
                                    taskItem.innerHTML = `
                                        <p class="text-gray-700 task-description" contenteditable="true">${task.description}</p>
                                        <div class="flex items-center justify-between text-sm mt-2 flex-wrap gap-2">
                                            <label class="text-gray-600">Prazo:</label>
                                            <input type="date" value="${task.deadline || ''}" class="text-gray-700 border rounded px-2 py-1 text-sm flex-grow mr-2">
                                            <label class="text-gray-600">Estado:</label>
                                            <select class="status-select border rounded px-2 py-1 text-sm status-${task.status}">
                                                <option value="em-progresso" ${task.status === 'em-progresso' ? 'selected' : ''}>Em Progresso</option>
                                                <option value="pendente" ${task.status === 'pendente' ? 'selected' : ''}>Pendente</option>
                                                <option value="concluido" ${task.status === 'concluido' ? 'selected' : ''}>Concluído</option>
                                            </select>
                                            <label class="text-gray-600">Prioridade:</label>
                                            <select class="priority-select border rounded px-2 py-1 text-sm priority-${task.priority || 'media'}">
                                                <option value="alta" ${task.priority === 'alta' ? 'selected' : ''}>Alta</option>
                                                <option value="media" ${task.priority === 'media' ? 'selected' : ''}>Média</option>
                                                <option value="baixa" ${task.priority === 'baixa' ? 'selected' : ''}>Baixa</option>
                                            </select>
                                        </div>
                                        <div class="flex space-x-2 mt-3">
                                            <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300 remove-task-btn">Remover 🗑️</button>
                                        </div>
                                    `;
                                    groupDiv.appendChild(taskItem);
                                });

                                // Adiciona o formulário inline de adição de tarefas
                                const inlineFormHtml = `
                                    <div class="add-task-inline-form mt-4 p-4 border rounded-lg bg-gray-50 hidden">
                                        <h4 class="font-semibold mb-2 text-gray-700">Adicionar Nova Tarefa:</h4>
                                        <textarea class="shadow-sm border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mb-2 task-description-input-inline" rows="2" placeholder="Descrição da tarefa..."></textarea>
                                        <div class="flex flex-wrap space-x-2 mb-2">
                                            <input type="date" class="shadow-sm border rounded w-1/3 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-deadline-input-inline">
                                            <select class="shadow-sm border rounded w-1/4 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-status-input-inline">
                                                <option value="em-progresso">Em Progresso</option>
                                                <option value="pendente">Pendente</option>
                                                <option value="concluido">Concluído</option>
                                            </select>
                                            <select class="shadow-sm border rounded w-1/4 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-priority-input-inline">
                                                <option value="alta">Alta</option>
                                                <option value="media" selected>Média</option>
                                                <option value="baixa">Baixa</option>
                                            </select>
                                        </div>
                                        <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 add-task-inline-btn">Adicionar</button>
                                        <button class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-300 ml-2 cancel-add-task-inline-btn">Cancelar</button>
                                    </div>
                                    <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 toggle-add-task-form-btn mt-4">Adicionar Tarefa a este grupo +</button>
                                `;
                                groupDiv.insertAdjacentHTML('beforeend', inlineFormHtml);
                                tasksContainer.appendChild(groupDiv);
                            });
                        }

                        // Popula as apresentações (se existirem e se o grupo de apresentações não tiver sido criado pelas taskGroups)
                        const presentationsGroup = document.querySelector('.task-group[data-responsible="Apresentações"]');
                        if (meetingData.presentations && meetingData.presentations.length > 0) {
                            if (!presentationsGroup) {
                                // Se o grupo de apresentações não existe, cria um novo
                                const newPresentationsGroupDiv = document.createElement('div');
                                newPresentationsGroupDiv.classList.add('mb-6', 'task-group');
                                newPresentationsGroupDiv.setAttribute('data-responsible', 'Apresentações');

                                const h3 = document.createElement('h3');
                                h3.classList.add('text-xl', 'font-bold', 'mb-2', 'text-gray-800');
                                h3.contentEditable = true;
                                h3.textContent = `Apresentações`;
                                newPresentationsGroupDiv.appendChild(h3);

                                const ul = document.createElement('ul');
                                ul.classList.add('list-disc', 'list-inside', 'text-gray-700');
                                ul.id = 'presentationsList';
                                newPresentationsGroupDiv.appendChild(ul);

                                const inlineFormHtml = `
                                    <div class="add-task-inline-form mt-4 p-4 border rounded-lg bg-gray-50 hidden">
                                        <h4 class="font-semibold mb-2 text-gray-700">Adicionar Nova Apresentação:</h4>
                                        <textarea class="shadow-sm border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mb-2 task-description-input-inline" rows="2" placeholder="Descrição da apresentação..."></textarea>
                                        <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 add-presentation-inline-btn">Adicionar</button>
                                        <button class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-300 ml-2 cancel-add-task-inline-btn">Cancelar</button>
                                    </div>
                                    <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 toggle-add-task-form-btn mt-4">Adicionar Apresentação +</button>
                                `;
                                newPresentationsGroupDiv.insertAdjacentHTML('beforeend', inlineFormHtml);
                                tasksContainer.appendChild(newPresentationsGroupDiv);
                            }

                            const targetPresentationsList = document.querySelector('#presentationsList');
                            targetPresentationsList.innerHTML = ''; // Limpa a lista existente
                            meetingData.presentations.forEach(presentation => {
                                const li = document.createElement('li');
                                li.contentEditable = true;
                                li.textContent = presentation;
                                targetPresentationsList.appendChild(li);
                            });
                        }


                        renumberTaskGroups(); // Re-numera os grupos após o carregamento
                        addInputListeners(); // Re-anexa os listeners aos novos elementos
                        attachListeners(); // Re-anexa listeners para botões de ação
                        applyFiltersAndSort(); // Aplica filtros e ordenação
                        console.log('Dados da reunião carregados do localStorage.');
                    } else {
                        console.log('Nenhum dado salvo encontrado no localStorage. Carregando dados padrão do HTML.');
                        // Se não houver dados salvos, os dados iniciais do HTML serão usados.
                        // Certifica-se de que os listeners e classes de status/prioridade sejam aplicados.
                        renumberTaskGroups();
                        addInputListeners();
                        attachListeners();
                        applyFiltersAndSort();
                    }
                } catch (e) {
                    console.error('Erro ao carregar dados do localStorage:', e);
                    console.log('Tentando carregar dados padrão do HTML devido a erro no localStorage.');
                    // Em caso de erro, garante que a página ainda funcione com os dados padrão.
                    renumberTaskGroups();
                    addInputListeners();
                    attachListeners();
                    applyFiltersAndSort();
                }
            }


            // Adiciona listeners para quando o conteúdo editável muda
            function addInputListeners() {
                document.querySelectorAll('[contenteditable="true"]').forEach(element => {
                    element.removeEventListener('input', saveMeetingData); // Evita duplicação
                    element.addEventListener('input', saveMeetingData);
                });
                document.querySelectorAll('input[type="date"]').forEach(element => {
                    element.removeEventListener('change', saveMeetingData); // Evita duplicação
                    element.addEventListener('change', saveMeetingData);
                });
                document.querySelectorAll('.status-select, .priority-select').forEach(element => {
                    element.removeEventListener('change', handleSelectChangeAndSave); // Evita duplicação
                    element.addEventListener('change', handleSelectChangeAndSave);
                    // Aplica a classe de status/prioridade inicial ao carregar
                    if (element.classList.contains('status-select')) {
                        // Remove todas as classes de status existentes e adiciona a nova
                        element.classList.remove('status-pendente', 'status-em-progresso', 'status-concluido');
                        element.classList.add(`status-${element.value}`);
                    } else if (element.classList.contains('priority-select')) {
                        // Remove todas as classes de prioridade existentes e adiciona a nova
                        element.classList.remove('priority-alta', 'priority-media', 'priority-baixa');
                        element.classList.add(`priority-${element.value}`);
                    }
                });
            }

            // Função para lidar com a mudança nos selects
            function handleSelectChangeAndSave(event) {
                const element = event.target;
                if (element.classList.contains('status-select')) {
                    element.classList.remove('status-pendente', 'status-em-progresso', 'status-concluido');
                    element.classList.add(`status-${element.value}`);
                } else if (element.classList.contains('priority-select')) {
                    element.classList.remove('priority-alta', 'priority-media', 'priority-baixa');
                    element.classList.add(`priority-${element.value}`);
                }
                saveMeetingData(); // Chama a função para salvar no localStorage
            }

            // --- Funções de Filtro e Ordenação ---
            function applyFiltersAndSort() {
                const taskGroups = document.querySelectorAll('.task-group');

                taskGroups.forEach(groupDiv => {
                    if (groupDiv.querySelector('#presentationsList')) {
                        // Não aplica filtro/ordenação para a lista de apresentações
                        return;
                    }

                    const taskItems = Array.from(groupDiv.querySelectorAll('.task-item'));

                    // 1. Filtrar
                    taskItems.forEach(taskItem => {
                        const status = taskItem.querySelector('.status-select').value;
                        if (currentFilter === 'all' || status === currentFilter) {
                            taskItem.style.display = ''; // Mostra
                        } else {
                            taskItem.style.display = 'none'; // Esconde
                        }
                    });

                    // 2. Coletar e Ordenar (apenas os visíveis)
                    const visibleTaskItems = taskItems.filter(item => item.style.display !== 'none');

                    visibleTaskItems.sort((a, b) => {
                        if (currentSort === 'deadline') {
                            const dateA = new Date(a.querySelector('input[type="date"]').value);
                            const dateB = new Date(b.querySelector('input[type="date"]').value);
                            return dateA - dateB;
                        } else if (currentSort === 'status') {
                            const statusOrder = { 'pendente': 1, 'em-progresso': 2, 'concluido': 3 };
                            const statusA = statusOrder[a.querySelector('.status-select').value];
                            const statusB = statusOrder[b.querySelector('.status-select').value];
                            return statusA - statusB;
                        } else if (currentSort === 'priority') {
                            const priorityOrder = { 'alta': 1, 'media': 2, 'baixa': 3 };
                            const priorityA = priorityOrder[a.querySelector('.priority-select').value];
                            const priorityB = priorityOrder[b.querySelector('.priority-select').value];
                            return priorityA - priorityB;
                        } else if (currentSort === 'description') {
                            const descA = a.querySelector('.task-description').textContent.toLowerCase();
                            const descB = b.querySelector('.task-description').textContent.toLowerCase();
                            return descA.localeCompare(descB);
                        }
                        return 0; // Padrão, sem alteração na ordem
                    });

                    // 3. Re-apendar os itens ordenados
                    const inlineFormDiv = groupDiv.querySelector('.add-task-inline-form');
                    visibleTaskItems.forEach(item => {
                        if (inlineFormDiv) {
                            groupDiv.insertBefore(item, inlineFormDiv);
                        } else {
                            groupDiv.appendChild(item);
                        }
                    });
                });
            }

            // Event listeners para os controles de filtro e ordenação
            filterStatusSelect.addEventListener('change', (event) => {
                currentFilter = event.target.value;
                applyFiltersAndSort();
                saveMeetingData(); // Salva após mudança de filtro/ordenação
            });

            sortOrderSelect.addEventListener('change', (event) => {
                currentSort = event.target.value;
                applyFiltersAndSort();
                saveMeetingData(); // Salva após mudança de filtro/ordenação
            });


            // Função para formatar a data de AAAA-MM-DD para DD/MM/AAAA
            function formatDateToDDMMYYYY(dateString) {
                if (!dateString) return '';
                const [year, month, day] = dateString.split('-');
                return `${day}/${month}/${year}`;
            }

            // Função para formatar a data de DD/MM/AAAA para AAAA-MM-DD
            function formatDateToYYYYMMDD(dateString) {
                if (!dateString) return '';
                const [day, month, year] = dateString.split('/');
                return `${year}-${month}-${day}`;
            }

            // Função para exibir o modal
            function showModal(title, content) {
                modalTitle.textContent = title;
                modalBody.innerHTML = content;
                responseModal.style.display = 'flex';
            }

            // Função para esconder o modal
            function hideModal() {
                responseModal.style.display = 'none';
                modalTitle.textContent = '';
                modalBody.innerHTML = '';
            }

            // Event listener para fechar o modal
            closeButton.addEventListener('click', hideModal);
            window.addEventListener('click', (event) => {
                if (event.target == responseModal) {
                    hideModal();
                }
            });

            // Função para chamar a API Gemini para gerar resumo geral
            async function generateOverallSummary() {
                const config = loadConfig();
                const geminiApiKey = config.geminiApiKey;

                if (!geminiApiKey) {
                    showConfigModal('Chave da API Gemini Ausente', 'Por favor, insira a sua chave da API Gemini na configuração para usar esta funcionalidade.');
                    return;
                }

                loadingSpinner.style.display = 'block';
                modalBody.innerHTML = '';
                showModal('Gerando Resumo Geral...', '<p>Por favor, aguarde...</p>');

                try {
                    const allTaskDescriptions = Array.from(document.querySelectorAll('.task-description'))
                                                    .map(element => element.textContent.trim())
                                                    .filter(text => text && !text.startsWith("Nenhuma tarefa específica mencionada na ata original para"))
                                                    .join('\n\n');

                    console.log('Descrições de tarefas coletadas:', allTaskDescriptions);

                    if (!allTaskDescriptions.trim()) {
                        showModal('Atenção', 'Não há tarefas para resumir.');
                        loadingSpinner.style.display = 'none';
                        return;
                    }

                    let chatHistory = [];
                    const prompt = `Resuma todas as seguintes tarefas de ata de reunião de forma concisa e objetiva:\n\n${allTaskDescriptions}`;
                    chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                    const payload = { contents: chatHistory };

                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${geminiApiKey}`;

                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    console.log('Resposta bruta do fetch:', response);

                    if (!response.ok) {
                        const errorText = await response.text();
                        console.error('Erro na resposta da API:', response.status, response.statusText, errorText);
                        showModal('Erro', `Falha na API: ${response.status} ${response.statusText}. Detalhes: ${errorText}`);
                        loadingSpinner.style.display = 'none';
                        return;
                    }

                    const result = await response.json();
                    console.log('Resposta JSON da API:', result);

                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        const text = result.candidates[0].content.parts[0].text;
                        showModal('Resumo Geral da Ata', text);
                    } else {
                        showModal('Erro', 'Não foi possível gerar o resumo geral. A resposta da API estava vazia ou em um formato inesperado.');
                    }
                } catch (error) {
                    console.error('Erro ao chamar a API Gemini para resumo geral:', error);
                    showModal('Erro', 'Ocorreu um erro ao processar sua solicitação de resumo geral. Verifique o console para mais detalhes.');
                } finally {
                    loadingSpinner.style.display = 'none';
                }
            }

            // Função para adicionar uma nova tarefa a um grupo de responsável
            function appendTaskToResponsibleGroup(responsible, description, deadline, status, priority) {
                const newTaskItem = document.createElement('div');
                newTaskItem.classList.add('task-item', 'py-3');
                newTaskItem.innerHTML = `
                    <p class="text-gray-700 task-description" contenteditable="true">${description}</p>
                    <div class="flex items-center justify-between text-sm mt-2 flex-wrap gap-2">
                        <label class="text-gray-600">Prazo:</label>
                        <input type="date" value="${deadline || ''}" class="text-gray-700 border rounded px-2 py-1 text-sm flex-grow mr-2">
                        <label class="text-gray-600">Estado:</label>
                        <select class="status-select border rounded px-2 py-1 text-sm status-${status}">
                            <option value="em-progresso" ${status === 'em-progresso' ? 'selected' : ''}>Em Progresso</option>
                            <option value="pendente" ${status === 'pendente' ? 'selected' : ''}>Pendente</option>
                            <option value="concluido" ${status === 'concluido' ? 'selected' : ''}>Concluído</option>
                        </select>
                        <label class="text-gray-600">Prioridade:</label>
                        <select class="priority-select border rounded px-2 py-1 text-sm priority-${priority || 'media'}">
                            <option value="alta" ${priority === 'alta' ? 'selected' : ''}>Alta</option>
                            <option value="media" ${priority === 'media' ? 'selected' : ''}>Média</option>
                            <option value="baixa" ${priority === 'baixa' ? 'selected' : ''}>Baixa</option>
                        </select>
                    </div>
                    <div class="flex space-x-2 mt-3">
                        <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300 remove-task-btn">Remover 🗑️</button>
                    </div>
                `;

                let targetTaskGroup = document.querySelector(`.task-group[data-responsible="${responsible}"]`);

                // Se o grupo do responsável não existir, cria um novo
                if (!targetTaskGroup) {
                    targetTaskGroup = document.createElement('div');
                    targetTaskGroup.classList.add('mb-6', 'task-group');
                    targetTaskGroup.setAttribute('data-responsible', responsible);

                    let maxNumber = 0;
                    const existingTaskGroups = tasksContainer.querySelectorAll('.task-group h3');
                    existingTaskGroups.forEach(h3 => {
                        const match = h3.textContent.match(/^(\d+)\./);
                        if (match && parseInt(match[1]) > maxNumber) {
                            maxNumber = parseInt(match[1]);
                        }
                    });
                    const newGroupNumber = maxNumber + 1;

                    const newGroupTitle = document.createElement('h3');
                    newGroupTitle.classList.add('text-xl', 'font-bold', 'mb-2', 'text-gray-800');
                    newGroupTitle.setAttribute('contenteditable', 'true');
                    newGroupTitle.textContent = `${newGroupNumber}. ${responsible}`;
                    targetTaskGroup.appendChild(newGroupTitle);

                    // Adiciona o formulário inline de adição de tarefas ao novo grupo
                    const inlineFormHtml = `
                        <div class="add-task-inline-form mt-4 p-4 border rounded-lg bg-gray-50 hidden">
                            <h4 class="font-semibold mb-2 text-gray-700">Adicionar Nova Tarefa:</h4>
                            <textarea class="shadow-sm border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mb-2 task-description-input-inline" rows="2" placeholder="Descrição da tarefa..."></textarea>
                            <div class="flex flex-wrap space-x-2 mb-2">
                                <input type="date" class="shadow-sm border rounded w-1/3 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-deadline-input-inline">
                                <select class="shadow-sm border rounded w-1/4 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-status-input-inline">
                                    <option value="em-progresso">Em Progresso</option>
                                    <option value="pendente">Pendente</option>
                                    <option value="concluido">Concluído</option>
                                </select>
                                <select class="shadow-sm border rounded w-1/4 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline task-priority-input-inline">
                                    <option value="alta">Alta</option>
                                    <option value="media" selected>Média</option>
                                    <option value="baixa">Baixa</option>
                                </select>
                            </div>
                            <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 add-task-inline-btn">Adicionar</button>
                            <button class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-300 ml-2 cancel-add-task-inline-btn">Cancelar</button>
                        </div>
                        <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-sm transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300 toggle-add-task-form-btn mt-4">Adicionar Tarefa a este grupo +</button>
                    `;
                    targetTaskGroup.insertAdjacentHTML('beforeend', inlineFormHtml);


                    // Encontra a posição correta para inserir o novo grupo para manter a ordem numérica
                    let inserted = false;
                    const allGroups = Array.from(tasksContainer.querySelectorAll('.task-group'));
                    for (let i = 0; i < allGroups.length; i++) {
                        const groupNumMatch = allGroups[i].querySelector('h3').textContent.match(/^(\d+)\./);
                        const groupNumber = groupNumMatch ? parseInt(groupNumMatch[1]) : 0;
                        if (newGroupNumber < groupNumber) {
                            tasksContainer.insertBefore(targetTaskGroup, allGroups[i]);
                            inserted = true;
                            break;
                        }
                    }
                    if (!inserted) {
                        tasksContainer.appendChild(targetTaskGroup);
                    }

                    // Re-numera todos os grupos após a inserção
                    renumberTaskGroups();

                }

                // Adiciona a nova tarefa ao grupo do responsável
                // Insere antes do formulário inline, se ele existir
                const inlineFormDiv = targetTaskGroup.querySelector('.add-task-inline-form');
                if (inlineFormDiv) {
                    targetTaskGroup.insertBefore(newTaskItem, inlineFormDiv);
                } else {
                    targetTaskGroup.appendChild(newTaskItem);
                }

                saveMeetingData(); // Chama a função para salvar no localStorage
                attachListeners(); // Re-anexa os event listeners
                addInputListeners(); // Re-anexa listeners
                applyFiltersAndSort(); // Aplica filtros e ordenação após adicionar nova tarefa
            }


            // Função para remover tarefa
            function removeTask(event) {
                const taskItemToRemove = event.target.closest('.task-item');
                const parentTaskGroup = taskItemToRemove.closest('.task-group');
                taskItemToRemove.remove();

                // Se o grupo de tarefas ficar vazio (e não for o grupo de Apresentações que tem UL), remove o cabeçalho do grupo também
                if (parentTaskGroup && parentTaskGroup.querySelectorAll('.task-item').length === 0 && parentTaskGroup.querySelectorAll('ul').length === 0) {
                    parentTaskGroup.remove();
                    renumberTaskGroups(); // Re-numera os grupos após a remoção
                }
                saveMeetingData(); // Chama a função para salvar no localStorage
                applyFiltersAndSort(); // Aplica filtros e ordenação após remover tarefa
            }

            // Função para re-numerar os grupos de tarefas
            function renumberTaskGroups() {
                const taskGroups = tasksContainer.querySelectorAll('.task-group');
                let currentNumber = 1;
                taskGroups.forEach(group => {
                    const h3 = group.querySelector('h3');
                    // Ignora o grupo de apresentações ao re-numerar, pois ele não tem um número
                    if (h3 && group.dataset.responsible !== "Apresentações") {
                        const originalText = h3.textContent.replace(/^\d+\.\s*/, ''); // Remove o número antigo
                        h3.textContent = `${currentNumber}. ${originalText}`;
                        currentNumber++;
                    } else if (h3 && group.dataset.responsible === "Apresentações") {
                        h3.textContent = `Apresentações`; // Garante que o título "Apresentações" não seja numerado
                    }
                });
            }


            // Função para anexar event listeners para todos os botões dinâmicos
            function attachListeners() {
                // Remover
                const currentRemoveButtons = document.querySelectorAll('.remove-task-btn');
                currentRemoveButtons.forEach(button => {
                    button.removeEventListener('click', removeTask); // Evita duplicação
                    button.addEventListener('click', removeTask);
                });

                // Toggle formulário inline de adicionar tarefa
                const toggleFormsButtons = document.querySelectorAll('.toggle-add-task-form-btn');
                toggleFormsButtons.forEach(button => {
                    button.removeEventListener('click', toggleInlineForm);
                    button.addEventListener('click', toggleInlineForm);
                });

                // Adicionar tarefa inline
                const addInlineButtons = document.querySelectorAll('.add-task-inline-btn');
                addInlineButtons.forEach(button => {
                    button.removeEventListener('click', addInlineTask);
                    button.addEventListener('click', addInlineTask);
                });

                // Cancelar adição de tarefa inline
                const cancelInlineButtons = document.querySelectorAll('.cancel-add-task-inline-btn');
                cancelInlineButtons.forEach(button => {
                    button.removeEventListener('click', cancelInlineTask);
                    button.addEventListener('click', cancelInlineTask);
                });

                // Apresentações: Adicionar item de lista
                const addPresentationInlineButtons = document.querySelectorAll('.add-presentation-inline-btn');
                addPresentationInlineButtons.forEach(button => {
                    button.removeEventListener('click', addInlinePresentation);
                    button.addEventListener('click', addInlinePresentation);
                });
            }

            // Função para alternar a visibilidade do formulário inline
            function toggleInlineForm(event) {
                const taskGroup = event.target.closest('.task-group');
                const inlineForm = taskGroup.querySelector('.add-task-inline-form');
                inlineForm.classList.toggle('hidden');
                event.target.classList.toggle('hidden'); // Esconde o botão de toggle
            }

            // Função para adicionar tarefa a partir do formulário inline
            function addInlineTask(event) {
                const inlineForm = event.target.closest('.add-task-inline-form');
                const taskGroup = inlineForm.closest('.task-group');
                const descriptionInput = inlineForm.querySelector('.task-description-input-inline');
                const deadlineInput = inlineForm.querySelector('.task-deadline-input-inline');
                const statusInput = inlineForm.querySelector('.task-status-input-inline');
                const priorityInput = inlineForm.querySelector('.task-priority-input-inline');


                const description = descriptionInput.value.trim();
                const deadline = deadlineInput.value;
                const status = statusInput.value;
                const priority = priorityInput.value;
                const responsible = taskGroup.dataset.responsible; // Pega o responsável do data-attribute

                if (description === "") {
                    showModal('Erro', 'A descrição da tarefa não pode estar vazia.');
                    return;
                }

                appendTaskToResponsibleGroup(responsible, description, deadline, status, priority);

                // Limpa e esconde o formulário
                descriptionInput.value = '';
                deadlineInput.value = '';
                statusInput.value = 'em-progresso';
                priorityInput.value = 'media';
                inlineForm.classList.add('hidden');
                taskGroup.querySelector('.toggle-add-task-form-btn').classList.remove('hidden'); // Mostra o botão de toggle
            }

            // Função para cancelar a adição de tarefa inline
            function cancelInlineTask(event) {
                const inlineForm = event.target.closest('.add-task-inline-form');
                const taskGroup = inlineForm.closest('.task-group');
                inlineForm.classList.add('hidden');
                taskGroup.querySelector('.toggle-add-task-form-btn').classList.remove('hidden'); // Mostra o botão de toggle
            }

            // Função para adicionar item de apresentação inline
            function addInlinePresentation(event) {
                const inlineForm = event.target.closest('.add-task-inline-form');
                const presentationsList = inlineForm.closest('.task-group').querySelector('#presentationsList');
                const descriptionInput = inlineForm.querySelector('.task-description-input-inline');
                const description = descriptionInput.value.trim();

                if (description === "") {
                    showModal('Erro', 'A descrição da apresentação não pode estar vazia.');
                    return;
                }

                const newLi = document.createElement('li');
                newLi.setAttribute('contenteditable', 'true');
                newLi.textContent = description;
                presentationsList.appendChild(newLi);

                descriptionInput.value = ''; // Limpa o campo
                inlineForm.classList.add('hidden');
                inlineForm.closest('.task-group').querySelector('.toggle-add-task-form-btn').classList.remove('hidden'); // Mostra o botão de toggle
                saveMeetingData(); // Chama a função para salvar no localStorage
            }


            // Função para salvar o HTML editado
            saveAsHtmlBtn.addEventListener('click', () => {
                // Esconde elementos interativos antes de salvar
                const elementsToHide = document.querySelectorAll('.remove-task-btn, .toggle-add-task-form-btn, .add-task-inline-form, .filter-sort-controls, .add-task-inline-form + button');
                elementsToHide.forEach(el => el.style.display = 'none');

                const htmlContent = document.documentElement.outerHTML;
                const blob = new Blob([htmlContent], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'ata_de_reuniao_editada.html';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                // Restaura a visibilidade dos elementos
                elementsToHide.forEach(el => el.style.display = '');
            });

            // Função para salvar como PDF
            saveAsPdfBtn.addEventListener('click', () => {
                // Esconde elementos interativos antes de gerar o PDF
                const elementsToHide = document.querySelectorAll('.remove-task-btn, .toggle-add-task-form-btn, .add-task-inline-form, #generateOverallSummaryBtn, #saveAsHtmlBtn, #saveAsPdfBtn, .filter-sort-controls, .add-task-inline-form + button');
                elementsToHide.forEach(el => el.style.display = 'none');

                // Armazena os inputs de data originais para restaurá-los depois
                const dateInputs = document.querySelectorAll('input[type="date"]');
                const originalDateInputMap = new Map(); // Mapa para armazenar o input original e seu pai/próximo irmão

                dateInputs.forEach((input, index) => {
                    const formattedDate = formatDateToDDMMYYYY(input.value);
                    const textSpan = document.createElement('span');
                    textSpan.textContent = formattedDate;
                    textSpan.classList.add('pdf-date-placeholder'); // Adiciona uma classe para identificar facilmente esses spans mais tarde
                    textSpan.style.display = 'inline-block'; // Mantém o layout

                    // Armazena o input original e seu contexto para restauração
                    originalDateInputMap.set(textSpan, { originalInput: input, parent: input.parentNode, nextSibling: input.nextSibling });

                    // Substitui o input pelo span
                    input.parentNode.replaceChild(textSpan, input);
                });

                const element = document.body; // Ou o elemento que você quer exportar

                html2pdf(element, {
                    margin: 10,
                    filename: 'ata_de_reuniao.pdf',
                    image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { scale: 2, logging: true, dpi: 192, letterRendering: true },
                    jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
                }).then(() => {
                    // Restaura os inputs de data originais
                    originalDateInputMap.forEach((originalData, textSpan) => {
                        const { originalInput, parent, nextSibling } = originalData;
                        if (parent) {
                            if (nextSibling) {
                                parent.insertBefore(originalInput, nextSibling);
                            } else {
                                parent.appendChild(originalInput);
                            }
                            textSpan.remove(); // Remove o span temporário
                        }
                    });

                    // Restaura a visibilidade dos outros elementos
                    elementsToHide.forEach(el => el.style.display = '');
                });
            });


            // Inicializa os event listeners para os botões existentes na carga da página
            attachListeners();

            // Adiciona event listener para o botão de resumo geral
            generateOverallSummaryBtn.addEventListener('click', generateOverallSummary);
        });
    </script>
</body>
</html>
